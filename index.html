<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Cadastro de Ocorrências - 2025</title>

  <!-- jsPDF para geração local de PDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <style>
    /* ===== Reset/Base ===== */
    * { 
      box-sizing: border-box; 
      margin: 0; 
      padding: 0; 
    }
    
    html, body {
      height: 100%;
    }
    
    body {
      font-family: Inter, "Segoe UI", Roboto, Arial, sans-serif;
      background: linear-gradient(135deg, #9fe7ff 0%, #b9f7c9 60%, #baf3ff 100%);
      color: #fff; 
      font-weight: 800; 
      padding: 18px;
      line-height: 1.5;
    }
    
    .app {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      gap: 18px;
    }
    
    /* ===== Header ===== */
    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 18px;
      border-radius: 14px;
      background: linear-gradient(90deg, rgba(0,31,63,0.95), rgba(0,78,120,0.95));
      box-shadow: 0 8px 30px rgba(0,0,0,0.15);
    }
    
    header h1 {
      font-size: 20px;
      margin: 0;
    }
    
    .header-controls {
      display: flex;
      gap: 10px;
      align-items: center;
    }
    
    /* ===== Cards e Layout ===== */
    .card {
      background: #2f3336;
      padding: 18px;
      border-radius: 12px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.15);
    }
    
    .flex {
      display: flex;
      gap: 18px;
      align-items: flex-start;
    }
    
    .col {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    
    /* ===== Formulários ===== */
    label {
      display: block;
      margin-bottom: 6px;
      font-size: 13px;
      font-weight: 700;
    }
    
    input[type="text"],
    input[type="email"],
    input[type="password"],
    select,
    textarea,
    input[type="date"] {
      width: 100%;
      padding: 10px 12px;
      border-radius: 8px;
      border: none;
      font-weight: 800;
      font-size: 14px;
      color: #111;
      background: #fff;
      transition: all 0.2s ease;
    }
    
    input:focus,
    select:focus,
    textarea:focus {
      outline: none;
      box-shadow: 0 0 0 2px rgba(42, 82, 152, 0.5);
    }
    
    textarea {
      min-height: 110px;
      resize: vertical;
      padding-top: 12px;
      font-family: inherit;
    }
    
    /* ===== Botões ===== */
    button {
      cursor: pointer;
      border: none;
      padding: 10px 14px;
      border-radius: 8px;
      font-weight: 900;
      box-shadow: 0 6px 18px rgba(0,0,0,0.15);
      transition: all 0.2s ease;
      font-size: 14px;
    }
    
    button:hover {
      transform: translateY(-1px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.2);
    }
    
    button:active {
      transform: translateY(0);
    }
    
    .btn-primary {
      background: linear-gradient(90deg, #1e3c72, #2a5298);
      color: #fff;
    }
    
    .btn-danger {
      background: linear-gradient(90deg, #e94b4b, #c62828);
      color: #fff;
    }
    
    .btn-success {
      background: linear-gradient(90deg, #4CAF50, #2E7D32);
      color: #fff;
    }
    
    .btn-secondary {
      background: linear-gradient(90deg, #6c757d, #5a6268);
      color: #fff;
    }
    
    /* ===== Textos e Elementos ===== */
    .subtitle {
      font-size: 14px;
      color: #d9f2ff;
      margin-bottom: 6px;
      font-weight: 800;
    }
    
    .muted {
      opacity: 0.9;
      font-weight: 700;
      color: #e7f7ff;
    }
    
    .pill {
      background: linear-gradient(90deg, #2a5298, #3a6bd1);
      color: #fff;
      padding: 6px 10px;
      border-radius: 999px;
      font-weight: 800;
      display: inline-block;
      margin: 2px;
    }
    
    /* ===== Histórico ===== */
    .historyList {
      max-height: 420px;
      overflow: auto;
      display: flex;
      flex-direction: column;
      gap: 10px;
      padding-right: 6px;
    }
    
    .historyItem {
      background: rgba(255,255,255,0.06);
      border-left: 5px solid rgba(255,255,255,0.06);
      padding: 12px;
      border-radius: 8px;
      color: #fff;
      font-weight: 700;
      transition: all 0.2s ease;
    }
    
    .historyItem:hover {
      background: rgba(255,255,255,0.1);
      border-left-color: rgba(255,255,255,0.3);
    }
    
    .historyItem .meta {
      font-size: 13px;
      color: #dbefff;
      font-weight: 800;
      display: flex;
      justify-content: space-between;
      gap: 8px;
      align-items: center;
    }
    
    .historyItem .desc {
      margin-top: 8px;
      color: #e7f7ff;
      font-weight: 600;
      font-size: 14px;
    }
    
    /* ===== Modal ===== */
    .modal-root {
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      background: rgba(0,0,0,0.5);
      z-index: 2000;
      backdrop-filter: blur(4px);
    }
    
    .modal {
      width: 92%;
      max-width: 780px;
      background: #fff;
      color: #111;
      border-radius: 12px;
      padding: 24px;
      max-height: 84vh;
      overflow: auto;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }
    
    .studentList {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    
    /* ===== Login ===== */
    .login-options {
      display: flex;
      gap: 12px;
      margin-bottom: 18px;
    }
    
    .login-option {
      flex: 1;
      text-align: center;
      padding: 12px;
      border-radius: 8px;
      cursor: pointer;
      background: rgba(255,255,255,0.1);
      transition: all 0.2s ease;
      font-weight: 700;
    }
    
    .login-option:hover {
      background: rgba(255,255,255,0.2);
    }
    
    .login-option.active {
      background: linear-gradient(90deg, rgba(0,78,120,0.8), rgba(0,120,120,0.8));
    }
    
    .access-area {
      display: none;
    }
    
    /* ===== Formulários Responsivos ===== */
    .form-row {
      display: flex;
      gap: 12px;
      margin-bottom: 12px;
    }
    
    .form-group {
      flex: 1;
      display: flex;
      flex-direction: column;
    }
    
    .form-group label {
      margin-bottom: 6px;
    }
    
    .form-group-small {
      flex: 0.5;
    }
    
    .form-group-medium {
      flex: 1.2;
    }
    
    .form-group-large {
      flex: 2;
    }
    
    .form-group-xlarge {
      flex: 2.5;
    }
    
    /* ===== Área de Gestão ===== */
    .gestao-form .form-group {
      flex: 1;
    }
    
    .gestao-form .form-row {
      margin-bottom: 15px;
    }
    
    .gestao-form input,
    .gestao-form select,
    .gestao-form textarea {
      width: 100%;
      padding: 12px;
      font-size: 15px;
    }
    
    /* ===== Checkboxes ===== */
    .checkbox-group {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 8px;
    }
    
    .checkbox-item {
      background: #efefef;
      color: #111;
      padding: 6px 10px;
      border-radius: 999px;
      display: inline-flex;
      align-items: center;
      transition: all 0.2s ease;
      cursor: pointer;
    }
    
    .checkbox-item:hover {
      background: #ddd;
    }
    
    .checkbox-item input {
      margin-right: 4px;
    }
    
    /* ===== Classificação ===== */
    .classification-container {
      display: flex;
      flex-direction: column;
      width: auto;
      min-width: 250px;
    }
    
    /* ===== Mensagens de Sucesso ===== */
    .success-message {
      display: none;
      margin-top: 10px;
      background: linear-gradient(90deg, #4CAF50, #2E7D32);
      padding: 10px;
      border-radius: 8px;
      color: #fff;
      font-weight: 900;
      text-align: center;
    }
    
    /* ===== Loader ===== */
    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }
    
    .loader {
      width: 18px;
      height: 18px;
      border: 3px solid rgba(255,255,255,0.2);
      border-top-color: #fff;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      display: inline-block;
    }
    
    /* ===== Responsividade ===== */
    @media (max-width: 980px) {
      .flex {
        flex-direction: column;
      }
      
      header {
        flex-direction: column;
        gap: 8px;
        align-items: flex-start;
      }
      
      .login-options {
        flex-direction: column;
      }
      
      .form-row {
        flex-direction: column;
      }
      
      .classification-container {
        width: 100%;
      }
      
      .gestao-form .form-row {
        flex-direction: column;
      }
    }
    
    @media (max-width: 600px) {
      body {
        padding: 12px;
      }
      
      .app {
        gap: 12px;
      }
      
      .card {
        padding: 12px;
      }
      
      header {
        padding: 12px;
      }
      
      header h1 {
        font-size: 18px;
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <!-- HEADER -->
    <header>
      <h1>2025 — Cadastro de Ocorrências</h1>
      <div class="header-controls">
        <div id="userDisplay" class="muted">Não autenticado</div>
        <button id="btnLogout" class="btn-danger" style="display:none" onclick="logout()">Sair</button>
        <button id="btnDownloadPdf" class="btn-success" style="display:none" onclick="downloadDocument()">Baixar Templates</button>
      </div>
    </header>

    <!-- LOGIN -->
    <div id="loginScreen" class="card" style="display:block">
      <div style="max-width:480px;margin:0 auto">
        <div class="subtitle">Selecione o tipo de acesso</div>
        <div class="login-options">
          <div class="login-option active" id="optionGestao" onclick="selectLoginOption('gestao')">
            Acesso Gestão
          </div>
          <div class="login-option" id="optionProfessor" onclick="selectLoginOption('professor')">
            Acesso Professor
          </div>
        </div>

        <div id="loginFormGestao" class="access-area">
          <div class="form-row">
            <div class="form-group form-group-xlarge">
              <label for="emailGestao">E-mail Gestão</label>
              <input id="emailGestao" type="email" placeholder="gestao@escola.com">
            </div>
            <div class="form-group form-group-medium">
              <label for="passwordGestao">Senha</label>
              <input id="passwordGestao" type="password" placeholder="senha">
            </div>
          </div>
          <div style="display:flex;gap:8px">
            <button class="btn-primary" onclick="login('gestao')">Entrar como Gestão</button>
            <button class="btn-danger" onclick="fillDemo('gestao')">Demo Gestão</button>
          </div>
          <p class="muted" style="margin-top:10px;font-size:13px">
            Use <strong>gestao@escola.com / gestao123</strong> para acesso à gestão
          </p>
        </div>

        <div id="loginFormProfessor" class="access-area">
          <div class="form-row">
            <div class="form-group form-group-xlarge">
              <label for="emailProfessor">E-mail Professor</label>
              <input id="emailProfessor" type="email" placeholder="professor@escola.com">
            </div>
            <div class="form-group form-group-medium">
              <label for="passwordProfessor">Senha</label>
              <input id="passwordProfessor" type="password" placeholder="senha">
            </div>
          </div>
          <div style="display:flex;gap:8px">
            <button class="btn-primary" onclick="login('professor')">Entrar como Professor</button>
            <button class="btn-danger" onclick="fillDemo('professor')">Demo Professor</button>
          </div>
          <p class="muted" style="margin-top:10px;font-size:13px">
            Use <strong>professor@escola.com / prof123</strong> para acesso ao professor
          </p>
        </div>
      </div>
    </div>

    <!-- MAIN APP - GESTÃO -->
    <div id="mainAppGestao" style="display:none;flex-direction:column;gap:14px">
      <div class="flex">
        <!-- GESTÃO -->
        <div class="card col" style="flex:1">
          <div class="subtitle">CADASTRO — GESTÃO</div>
          <div class="col gestao-form">
            <!-- Série/Turma em primeiro lugar -->
            <div class="form-row">
              <div class="form-group form-group-xlarge">
                <label>Série / Turma</label>
                <select id="serie_gestao" onchange="carregarAlunosPorTurmaGestao(this.value)">
                  <option value="">-- Selecione a turma --</option>
                </select>
              </div>
            </div>

            <!-- Aluno e RA -->
            <div class="form-row">
              <div class="form-group form-group-xlarge">
                <label>Aluno</label>
                <select id="aluno_gestao" onchange="preencherRAGestao(this.value)">
                  <option value="">-- Selecione o aluno --</option>
                </select>
              </div>
              <div class="form-group form-group-medium">
                <label>RA</label>
                <input id="ra_gestao" type="text" readonly>
              </div>
            </div>

            <div class="form-row">
              <div class="form-group form-group-xlarge">
                <label>Professor</label>
                <input id="professor_gestao" type="text">
              </div>
              <div class="form-group form-group-xlarge">
                <label>Disciplina</label>
                <input id="disciplina_gestao" type="text">
              </div>
            </div>

            <!-- Classificação com largura ajustada -->
            <div class="form-row">
              <div class="classification-container">
                <label>Classificação</label>
                <select id="classificacao_gestao" onchange="toggleSuspension('gestao')">
                  <option value="">Selecione</option>
                  <option value="OCORRÊNCIA">OCORRÊNCIA</option>
                  <option value="SUSPENSÃO">SUSPENSÃO</option>
                </select>
              </div>
              <div class="form-group" style="display:none" id="suspensionRow_gestao">
                <label>Data de retorno</label>
                <input id="dataRetorno_gestao" type="date">
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label>Descrição</label>
                <textarea id="descricao_gestao" placeholder="Descrição detalhada"></textarea>
              </div>
            </div>

            <div class="form-row">
              <button class="btn-primary" onclick="cadastrarOcorrenciaGestao()">Registrar (Gestão)</button>
              <button class="btn-success" onclick="generatePDFLocal()">Gerar PDF (local)</button>
            </div>

            <div id="successGestao" class="success-message">
              Ocorrência registrada com sucesso!
            </div>
          </div>
        </div>
      </div>

      <!-- HISTÓRICO GESTÃO -->
      <div class="card">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div class="subtitle">HISTÓRICO DE OCORRÊNCIAS - GESTÃO</div>
          <div style="display:flex;gap:8px;align-items:center">
            <button class="btn-primary" onclick="carregarHistoricoGestao()">Atualizar</button>
          </div>
        </div>
        <div style="margin-top:12px" id="historyListGestao" class="historyList"></div>
      </div>
    </div> <!-- mainAppGestao -->

    <!-- MAIN APP - PROFESSOR -->
    <div id="mainAppProfessor" style="display:none;flex-direction:column;gap:14px">
      <div class="flex">
        <!-- PROFESSOR -->
        <div class="card col" style="flex:1">
          <div class="subtitle">REGISTRO — PROFESSOR</div>
          <div class="col">
            <div class="form-row">
              <div class="form-group">
                <label>Professor</label>
                <select id="professor_select">
                  <option value="">-- Selecione --</option>
                </select>
              </div>
              <div class="form-group">
                <label>Turma</label>
                <select id="turma_select" onchange="onTurmaChange()">
                  <option value="">-- Selecione --</option>
                </select>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group form-group-large">
                <label>Alunos (clique para selecionar)</label>
                <input id="alunos_selected_input" type="text" readonly placeholder="Clique para selecionar" onclick="openStudentsModal()">
                <div id="selectedPills" style="margin-top:8px"></div>
              </div>
              <div class="form-group form-group-small">
                <label>Data</label>
                <input id="data_prof" type="date">
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label>Irregularidades</label>
                <div class="checkbox-group">
                  <label class="checkbox-item">
                    <input type="checkbox" name="irreg" value="Agressão"> Agressão
                  </label>
                  <label class="checkbox-item">
                    <input type="checkbox" name="irreg" value="Danos ao patrimônio"> Danos ao patrimônio
                  </label>
                  <label class="checkbox-item">
                    <input type="checkbox" name="irreg" value="Desacato"> Desacato
                  </label>
                  <label class="checkbox-item">
                    <input type="checkbox" name="irreg" value="Estava fora da sala"> Estava fora da sala
                  </label>
                  <label class="checkbox-item">
                    <input type="checkbox" name="irreg" value="Falta de material"> Falta de material
                  </label>
                  <label class="checkbox-item">
                    <input type="checkbox" name="irreg" value="Indisciplina"> Indisciplina
                  </label>
                  <label class="checkbox-item">
                    <input type="checkbox" name="irreg" value="Não realiza as atividades"> Não realiza as atividades
                  </label>
                  <label class="checkbox-item">
                    <input type="checkbox" name="irreg" value="Saiu da sala sem autorização"> Saiu da sala sem autorização
                  </label>
                  <label class="checkbox-item">
                    <input type="checkbox" name="irreg" value="Uso de celular"> Uso de celular
                  </label>
                </div>
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label>Descrição</label>
                <textarea id="descricao_prof" placeholder="Descreva a ocorrência..."></textarea>
              </div>
            </div>

            <div class="form-row">
              <button class="btn-primary" onclick="registrarOcorrenciaProfessor()">Registrar (Professor)</button>
              <button class="btn-danger" onclick="clearProfessorForm()">Limpar</button>
            </div>

            <div id="successProfessor" class="success-message">
              Ocorrência registrada com sucesso!
            </div>
          </div>
        </div>
      </div>

      <!-- HISTÓRICO PROFESSOR -->
      <div class="card">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div class="subtitle">HISTÓRICO DE OCORRÊNCIAS - PROFESSOR</div>
          <div style="display:flex;gap:8px;align-items:center">
            <button class="btn-primary" onclick="carregarHistoricoProfessor()">Atualizar</button>
          </div>
        </div>
        <div style="margin-top:12px" id="historyListProfessor" class="historyList"></div>
      </div>
    </div> <!-- mainAppProfessor -->

    <!-- MODAL ALUNOS -->
    <div id="modalRoot" class="modal-root">
      <div class="modal">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
          <h3 style="margin:0;color:#111">Selecionar Alunos</h3>
          <button class="btn-secondary" onclick="closeStudentsModal()">Fechar</button>
        </div>
        <input type="text" id="studentSearch" placeholder="Buscar aluno..." onkeyup="filterStudentList()" style="margin-bottom:12px">
        <div id="studentList" class="studentList"></div>
        <button class="btn-primary" style="margin-top:12px" onclick="confirmStudents()">Confirmar Seleção</button>
      </div>
    </div>
  </div>

  <script>
    // ===== CONFIGURAÇÕES GLOBAIS =====
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxvrmZZGgwPST9p8FkCvN2tEWm9CWn-AFATIlmwJTO28A4EGcq23A_RS9ChNltHE0a_/exec'; // Substitua pelo URL do seu Apps Script
    const SHEET_GERAL = 'BANCODEDADOSGERAL';
    const SHEET_GESTAO = 'BANCODEALUNOS'; // Aba para registros da gestão
    const SHEET_PROF = 'OCORRENCIASDOSPROFESSORES'; // Aba para registros de professores
    const SHEET_PROFESSORES_LISTA = 'PROFESSORES'; // Aba para a lista de professores

    // ===== VARIÁVEIS GLOBAIS =====
    let currentUser = null;
    let professores = [];
    let turmas = [];
    let alunosDaTurmaAtual = []; // Usado para o modal do professor
    let alunosComRA = []; // Usado para a seleção de aluno/RA na gestão
    let alunosSelecionados = []; // Alunos selecionados no modal do professor

    // ===== INICIALIZAÇÃO =====
    document.addEventListener('DOMContentLoaded', () => {
      initializeApp();
    });

    function initializeApp() {
      // Define a data atual para o campo de data do professor
      document.getElementById('data_prof').value = new Date().toISOString().split('T')[0];
      
      // Seleciona Gestão por padrão
      selectLoginOption('gestao');
      
      // Carrega dados iniciais
      carregarProfessoresETurmas();
      carregarSeriesGestao();
    }

    // ===== FUNÇÕES DE LOGIN =====
    function selectLoginOption(option) {
      // Remove classes ativas
      document.getElementById('optionGestao').classList.remove('active');
      document.getElementById('optionProfessor').classList.remove('active');
      
      // Esconde formulários
      document.getElementById('loginFormGestao').style.display = 'none';
      document.getElementById('loginFormProfessor').style.display = 'none';

      // Ativa opção selecionada
      if (option === 'gestao') {
        document.getElementById('optionGestao').classList.add('active');
        document.getElementById('loginFormGestao').style.display = 'block';
      } else {
        document.getElementById('optionProfessor').classList.add('active');
        document.getElementById('loginFormProfessor').style.display = 'block';
      }
    }

    async function login(role) {
      const emailInput = document.getElementById(`email${role === 'gestao' ? 'Gestao' : 'Professor'}`);
      const passwordInput = document.getElementById(`password${role === 'gestao' ? 'Gestao' : 'Professor'}`);
      const email = emailInput.value.trim();
      const password = passwordInput.value.trim();

      if (!email || !password) {
        showAlert('Por favor, preencha todos os campos.');
        return;
      }

      // Simulação de autenticação
      let isAuthenticated = false;
      if (role === 'gestao' && email === 'gestao@escola.com' && password === 'gestao123') {
        isAuthenticated = true;
      } else if (role === 'professor' && email === 'professor@escola.com' && password === 'prof123') {
        isAuthenticated = true;
      }

      if (isAuthenticated) {
        currentUser = { email: email, role: role };
        
        // Atualiza interface
        document.getElementById('loginScreen').style.display = 'none';
        document.getElementById('userDisplay').textContent = `Logado como: ${email} (${role})`;
        document.getElementById('btnLogout').style.display = 'inline-block';
        document.getElementById('btnDownloadPdf').style.display = 'inline-block';

        // Mostra área correspondente
        if (role === 'gestao') {
          document.getElementById('mainAppGestao').style.display = 'flex';
          carregarHistoricoGestao();
        } else {
          document.getElementById('mainAppProfessor').style.display = 'flex';
          carregarHistoricoProfessor();
        }
      } else {
        showAlert('Credenciais inválidas.');
      }
    }

    function logout() {
      currentUser = null;
      
      // Reset da interface
      document.getElementById('loginScreen').style.display = 'block';
      document.getElementById('mainAppGestao').style.display = 'none';
      document.getElementById('mainAppProfessor').style.display = 'none';
      document.getElementById('userDisplay').textContent = 'Não autenticado';
      document.getElementById('btnLogout').style.display = 'none';
      document.getElementById('btnDownloadPdf').style.display = 'none';
      
      // Limpar campos de login
      document.getElementById('emailGestao').value = '';
      document.getElementById('passwordGestao').value = '';
      document.getElementById('emailProfessor').value = '';
      document.getElementById('passwordProfessor').value = '';
      
      // Volta para a tela de login da gestão
      selectLoginOption('gestao');
    }

    function fillDemo(role) {
      if (role === 'gestao') {
        document.getElementById('emailGestao').value = 'gestao@escola.com';
        document.getElementById('passwordGestao').value = 'gestao123';
      } else {
        document.getElementById('emailProfessor').value = 'professor@escola.com';
        document.getElementById('passwordProfessor').value = 'prof123';
      }
    }

    // ===== CARREGAMENTO DE DADOS =====
    async function carregarSeriesGestao() {
      try {
        const resp = await fetch(`${SCRIPT_URL}?endpoint=classes&sheet=${encodeURIComponent(SHEET_GERAL)}`);
        const json = await resp.json();
        
        if (json.status === 'success' && Array.isArray(json.classes)) {
          const series = json.classes;
          const serieSelect = document.getElementById('serie_gestao');
          serieSelect.innerHTML = '<option value="">-- Selecione a turma --</option>';
          
          series.forEach(s => {
            const option = document.createElement('option');
            option.value = s;
            option.textContent = s;
            serieSelect.appendChild(option);
          });
        } else {
          throw new Error('Resposta inválida da API');
        }
      } catch (err) {
        console.error('Erro ao carregar séries (gestão):', err);
        // Fallback para séries se a API falhar
        const fallbackSeries = Object.keys(getClassRanges());
        const serieSelect = document.getElementById('serie_gestao');
        serieSelect.innerHTML = '<option value="">-- Selecione a turma --</option>';
        
        fallbackSeries.forEach(s => {
          const option = document.createElement('option');
          option.value = s;
          option.textContent = s;
          serieSelect.appendChild(option);
        });
      }
    }

    async function carregarAlunosPorTurmaGestao(turma) {
      if (!turma) {
        document.getElementById('aluno_gestao').innerHTML = '<option value="">-- Selecione o aluno --</option>';
        document.getElementById('ra_gestao').value = '';
        return;
      }

      try {
        const resp = await fetch(`${SCRIPT_URL}?endpoint=students&sheet=${encodeURIComponent(SHEET_GERAL)}&turma=${encodeURIComponent(turma)}`);
        const json = await resp.json();

        if (json.status === 'success' && Array.isArray(json.students)) {
          alunosComRA = json.students;
        } else {
          alunosComRA = [];
        }

        const alunoSelect = document.getElementById('aluno_gestao');
        alunoSelect.innerHTML = '<option value="">-- Selecione o aluno --</option>';
        
        alunosComRA.forEach(aluno => {
          const option = document.createElement('option');
          option.value = aluno.nome;
          option.textContent = aluno.nome;
          option.setAttribute('data-ra', aluno.ra || '');
          alunoSelect.appendChild(option);
        });
      } catch(err) {
        console.error('Erro ao carregar alunos (gestão):', err);
        document.getElementById('aluno_gestao').innerHTML = '<option value="">-- Selecione o aluno --</option>';
        showAlert('Erro ao carregar alunos. Tente novamente.');
      }
    }

    function preencherRAGestao(nomeAluno) {
      const alunoSelect = document.getElementById('aluno_gestao');
      const selectedOption = alunoSelect.selectedOptions[0];
      const ra = selectedOption ? selectedOption.getAttribute('data-ra') : '';
      document.getElementById('ra_gestao').value = ra || '';
    }

    async function carregarProfessoresETurmas() {
      try {
        // Carregar professores da aba 'PROFESSORES'
        const r1 = await fetch(`${SCRIPT_URL}?endpoint=teachers&sheet=${encodeURIComponent(SHEET_PROFESSORES_LISTA)}`);
        const j1 = await r1.json();
        
        if (j1 && j1.status === 'success' && Array.isArray(j1.teachers)) {
          professores = j1.teachers;
        } else {
          professores = getFallbackProfessores();
        }

        const profSel = document.getElementById('professor_select');
        profSel.innerHTML = '<option value="">-- Selecione --</option>';
        professores.forEach(p => { 
          const o = document.createElement('option'); 
          o.value = p; 
          o.textContent = p; 
          profSel.appendChild(o); 
        });

        // Carregar turmas do sheet geral
        const r2 = await fetch(`${SCRIPT_URL}?endpoint=classes&sheet=${encodeURIComponent(SHEET_GERAL)}`);
        const j2 = await r2.json();
        
        if (j2 && j2.status === 'success' && Array.isArray(j2.classes)) {
          turmas = j2.classes;
        } else {
          turmas = Object.keys(getClassRanges());
        }

        const turmaSel = document.getElementById('turma_select');
        turmaSel.innerHTML = '<option value="">-- Selecione --</option>';
        turmas.forEach(t => { 
          const o = document.createElement('option'); 
          o.value = t; 
          o.textContent = t; 
          turmaSel.appendChild(o); 
        });
      } catch(err) {
        console.error('Erro carregar professores/turmas:', err);
        
        // Fallback
        professores = getFallbackProfessores();
        const profSel = document.getElementById('professor_select');
        profSel.innerHTML = '<option value="">-- Selecione --</option>';
        professores.forEach(p => { 
          const o = document.createElement('option'); 
          o.value = p; 
          o.textContent = p; 
          profSel.appendChild(o); 
        });

        turmas = Object.keys(getClassRanges());
        const turmaSel = document.getElementById('turma_select');
        turmaSel.innerHTML = '<option value="">-- Selecione --</option>';
        turmas.forEach(t => { 
          const o = document.createElement('option'); 
          o.value = t; 
          o.textContent = t; 
          turmaSel.appendChild(o); 
        });
      }
    }

    async function onTurmaChange() {
      const turma = document.getElementById('turma_select').value;
      if (!turma) {
        alunosDaTurmaAtual = []; 
        renderStudentList([]); 
        return; 
      }

      await carregarAlunosPorTurma(turma);
      renderStudentList(alunosDaTurmaAtual.map(a => a.nome));
    }

    async function carregarAlunosPorTurma(turma) {
      try {
        const resp = await fetch(`${SCRIPT_URL}?endpoint=students&sheet=${encodeURIComponent(SHEET_GERAL)}&turma=${encodeURIComponent(turma)}`);
        const json = await resp.json();
        
        if (json.status === 'success' && Array.isArray(json.students)) {
          alunosDaTurmaAtual = json.students;
        } else {
          alunosDaTurmaAtual = [];
        }
      } catch(err) {
        console.error('Erro get students:', err);
        alunosDaTurmaAtual = [];
      }
    }

    // ===== MODAL DE ALUNOS =====
    function openStudentsModal() {
      if (!alunosDaTurmaAtual || alunosDaTurmaAtual.length === 0) { 
        showAlert('Nenhum aluno encontrado para a turma selecionada.'); 
        return; 
      }

      document.getElementById('modalRoot').style.display = 'flex';
      renderStudentList(alunosDaTurmaAtual.map(a => a.nome));
      document.getElementById('studentSearch').value = '';
    }

    function closeStudentsModal() {
      document.getElementById('modalRoot').style.display = 'none'; 
    }

    function renderStudentList(list) {
      const container = document.getElementById('studentList');
      container.innerHTML = '';

      list.forEach(nome => {
        const row = document.createElement('div');
        row.style.display = 'flex';
        row.style.justifyContent = 'space-between';
        row.style.alignItems = 'center';
        row.style.padding = '8px';
        row.style.borderBottom = '1px solid #eee';
        row.style.borderRadius = '4px';
        row.style.transition = 'background-color 0.2s ease';

        row.addEventListener('mouseenter', () => {
          row.style.backgroundColor = '#f5f5f5';
        });

        row.addEventListener('mouseleave', () => {
          row.style.backgroundColor = 'transparent';
        });

        const lbl = document.createElement('div'); 
        lbl.textContent = nome;
        lbl.style.fontWeight = '600';

        const cb = document.createElement('input'); 
        cb.type = 'checkbox'; 
        cb.value = nome; 
        cb.checked = alunosSelecionados.includes(nome);

        cb.onchange = (e) => { 
          if (e.target.checked) {
            if (!alunosSelecionados.includes(nome)) alunosSelecionados.push(nome); 
          } else {
            alunosSelecionados = alunosSelecionados.filter(x => x !== nome); 
          }
        };

        row.appendChild(lbl); 
        row.appendChild(cb); 
        container.appendChild(row);
      });
    }

    function filterStudentList() { 
      const q = document.getElementById('studentSearch').value.toLowerCase(); 
      const filtered = alunosDaTurmaAtual.map(a => a.nome).filter(s => s.toLowerCase().includes(q));
      renderStudentList(filtered); 
    }

    function confirmStudents() {
      document.getElementById('alunos_selected_input').value = alunosSelecionados.join(', ');
      const pills = document.getElementById('selectedPills'); 
      pills.innerHTML = '';
      
      alunosSelecionados.forEach(a => { 
        const el = document.createElement('div');
        el.className = 'pill'; 
        el.textContent = a; 
        pills.appendChild(el); 
      });
      
      closeStudentsModal();
    }

    // ===== FUNÇÕES DE REGISTRO =====
    function toggleSuspension(area) {
      if (area === 'gestao') { 
        const val = document.getElementById('classificacao_gestao').value; 
        document.getElementById('suspensionRow_gestao').style.display = (val === 'SUSPENSÃO') ? 'flex' : 'none'; 
      }
    }

    async function cadastrarOcorrenciaGestao() {
      const alunoSelect = document.getElementById('aluno_gestao');
      const aluno = alunoSelect.value.trim();
      const turmaSelect = document.getElementById('serie_gestao');
      const serie = turmaSelect.value.trim();
      const professor = document.getElementById('professor_gestao').value.trim();
      const disciplina = document.getElementById('disciplina_gestao').value.trim();
      const classificacao = document.getElementById('classificacao_gestao').value;
      const descricao = document.getElementById('descricao_gestao').value.trim();
      const dataRetorno = document.getElementById('dataRetorno_gestao').value || null;
      const ra = document.getElementById('ra_gestao').value.trim();

      // Validação
      if (!aluno || !serie || !professor || !disciplina || !classificacao || !descricao) {
        showAlert('Preencha todos os campos obrigatórios.'); 
        return; 
      }

      if (classificacao === 'SUSPENSÃO' && !dataRetorno) { 
        showAlert('Informe data de retorno para suspensão.'); 
        return; 
      }

      const payload = {
        sheet: SHEET_GESTAO,
        startRow: 2,
        date: new Date().toISOString().split('T')[0],
        professor: professor,
        studentClass: serie,
        student: aluno,
        ra: ra,
        disciplina: disciplina,
        irregularities: classificacao + (dataRetorno ? (' - retorno: ' + dataRetorno) : ''),
        description: descricao
      };

      try {
        const resp = await fetch(`${SCRIPT_URL}?endpoint=occurrences`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });
        
        const j = await resp.json();
        
        if (j && j.status === 'success') {
          showSuccessMessage('successGestao');
          clearGestaoForm();
          carregarHistoricoGestao();
        } else {
          showAlert('Erro ao registrar: ' + (j && j.message ? j.message : 'Resposta inesperada'));
        }
      } catch(err) {
        console.error('Erro POST ocorrencia (gestao):', err);
        showAlert('Erro ao comunicar com o servidor.');
      }
    }

    async function registrarOcorrenciaProfessor() {
      const professor = document.getElementById('professor_select').value.trim();
      const turma = document.getElementById('turma_select').value.trim();
      const dataOc = document.getElementById('data_prof').value;
      const descricao = document.getElementById('descricao_prof').value.trim();

      // Validação
      if (!professor || !turma || !dataOc || alunosSelecionados.length === 0) {
        showAlert('Preencha todos os campos obrigatórios e selecione ao menos um aluno.');
        return; 
      }

      const irregs = Array.from(document.querySelectorAll('input[name="irreg"]:checked')).map(x => x.value);

      const payload = {
        sheet: SHEET_PROF,
        startRow: 2,
        date: dataOc,
        professor: professor,
        studentClass: turma,
        student: alunosSelecionados.join(', '),
        irregularities: irregs.join(', '),
        description: descricao
      };

      try {
        const resp = await fetch(`${SCRIPT_URL}?endpoint=occurrences`, { 
          method: 'POST', 
          headers: { 'Content-Type': 'application/json' }, 
          body: JSON.stringify(payload) 
        });
        
        const j = await resp.json();
        
        if (j && j.status === 'success') {
          showSuccessMessage('successProfessor');
          clearProfessorForm();
          carregarHistoricoProfessor();
        } else {
          showAlert('Erro ao registrar: ' + (j && j.message ? j.message : 'Resposta inesperada'));
        }
      } catch(err) {
        console.error('Erro POST ocorrencia (professor):', err);
        showAlert('Erro ao comunicar com o servidor.');
      }
    }

    // ===== FUNÇÕES DE LIMPEZA =====
    function clearGestaoForm() {
      document.getElementById('serie_gestao').value = "";
      document.getElementById('aluno_gestao').innerHTML = '<option value="">-- Selecione o aluno --</option>';
      document.getElementById('ra_gestao').value = "";
      document.getElementById('professor_gestao').value = "";
      document.getElementById('disciplina_gestao').value = "";
      document.getElementById('classificacao_gestao').value = "";
      document.getElementById('descricao_gestao').value = "";
      document.getElementById('suspensionRow_gestao').style.display = 'none';
    }

    function clearProfessorForm() {
      document.getElementById('professor_select').value = "";
      document.getElementById('turma_select').value = "";
      document.getElementById('alunos_selected_input').value = "";
      document.getElementById('selectedPills').innerHTML = "";
      document.getElementById('descricao_prof').value = ""; 
      alunosSelecionados = [];
      Array.from(document.querySelectorAll('input[name="irreg"]')).forEach(cb => cb.checked = false); 
      document.getElementById('data_prof').value = new Date().toISOString().split('T')[0];
    }

    // ===== CARREGAMENTO DE HISTÓRICO =====
    async function carregarHistoricoGestao() {
      const container = document.getElementById('historyListGestao');
      container.innerHTML = '<div style="display:flex;align-items:center;gap:8px"><div class="loader"></div><div class="muted">Carregando histórico...</div></div>';

      try {
        const resp = await fetch(`${SCRIPT_URL}?endpoint=occurrences&sheet=${encodeURIComponent(SHEET_GESTAO)}`);
        const json = await resp.json();

        const ocorrs = json.occurrences || json.data || [];
        container.innerHTML = "";
        
        if (!ocorrs || ocorrs.length == 0) { 
          container.innerHTML = '<div class="muted">Nenhuma ocorrência encontrada.</div>'; 
          return; 
        }

        // Exibe do mais recente para o mais antigo
        ocorrs.slice().reverse().forEach(r => {
          const historyItem = createHistoryItem(r, SHEET_GESTAO, true);
          container.appendChild(historyItem);
        });
      } catch(err) {
        console.error('Erro carregar histórico (gestão):', err);
        container.innerHTML = '<div class="muted">Erro ao carregar histórico.</div>';
      }
    }

    async function carregarHistoricoProfessor() {
      const container = document.getElementById('historyListProfessor');
      container.innerHTML = '<div style="display:flex;align-items:center;gap:8px"><div class="loader"></div><div class="muted">Carregando histórico...</div></div>';

      try {
        const resp = await fetch(`${SCRIPT_URL}?endpoint=occurrences&sheet=${encodeURIComponent(SHEET_PROF)}`);
        const json = await resp.json();

        const ocorrs = json.occurrences || json.data || [];
        container.innerHTML = "";
        
        if (!ocorrs || ocorrs.length == 0) { 
          container.innerHTML = '<div class="muted">Nenhuma ocorrência encontrada.</div>'; 
          return; 
        }

        ocorrs.slice().reverse().forEach(r => {
          const historyItem = createHistoryItem(r, SHEET_PROF, false);
          container.appendChild(historyItem);
        });
      } catch(err) {
        console.error('Erro carregar histórico (professor):', err);
        container.innerHTML = '<div class="muted">Erro ao carregar histórico.</div>';
      }
    }

    function createHistoryItem(r, sheetName, isGestao) {
      const id = r.id || r.ID || r.Id || null;
      const date = r.DATA || r.date || r.col1 || "";
      const prof = r.PROFESSOR || r.professor || r.col2 || "";
      const turma = r.TURMA || r.studentClass || r.col3 || "";
      const aluno = r.ALUNO || r.student || r.col4 || "";
      const ra = r.RA || r.ra || r.col5 || "";
      const irreg = r.IRREGULARIDADES || r.irregularities || (isGestao ? r.col6 : r.col5) || "";
      const desc = r.DESCRICAO || r.description || (isGestao ? r.col7 : r.col6) || "";

      const div = document.createElement('div'); 
      div.className = 'historyItem';

      const meta = document.createElement('div'); 
      meta.className = 'meta';
      meta.innerHTML = `<div><strong>${date}</strong> — <span class="muted">${prof}</span></div>`;

      const controls = document.createElement('div');
      controls.style.display = 'flex';
      controls.style.gap = '8px';

      // Botão gerar PDF
      const pdfBtn = document.createElement('button');
      pdfBtn.className = 'btn-success'; 
      pdfBtn.style.fontSize = '12px';
      pdfBtn.style.padding = '6px 10px';
      pdfBtn.textContent = 'PDF';
      pdfBtn.onclick = () => generatePdfFromBackend(id);

      // Botão excluir
      const delBtn = document.createElement('button');
      delBtn.className = 'btn-danger'; 
      delBtn.style.fontSize = '12px';
      delBtn.style.padding = '6px 10px';
      delBtn.textContent = 'Excluir';
      delBtn.onclick = () => deleteOccurrence(id, sheetName);

      controls.appendChild(pdfBtn);
      controls.appendChild(delBtn);
      meta.appendChild(controls);

      const descDiv = document.createElement('div'); 
      descDiv.className = 'desc';
      
      if (isGestao) {
        descDiv.innerHTML = `Aluno: <strong>${aluno}</strong> ${ra ? `(RA: ${ra})` : ''}<br>Turma: ${turma}<br>Disciplina: ${r.DISCIPLINA || r.disciplina || 'N/A'}<br>Classificação: ${irreg}<br>Descrição: ${desc}`;
      } else {
        descDiv.innerHTML = `Aluno(s): <strong>${aluno}</strong><br>Turma: ${turma}<br>Irregularidades: ${irreg}<br>Descrição: ${desc}`;
      }

      div.appendChild(meta); 
      div.appendChild(descDiv); 
      
      return div;
    }

    // ===== FUNÇÕES DE EXCLUSÃO E PDF =====
    async function deleteOccurrence(id, sheetName) {
      if (!confirm('Tem certeza que deseja excluir esta ocorrência?')) return;

      try {
        const resp = await fetch(`${SCRIPT_URL}?endpoint=delete-occurrence`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ occurrenceId: id, sheet: sheetName })
        });
        
        const j = await resp.json();
        
        if (j && j.status === 'success') {
          showAlert('Ocorrência excluída com sucesso!');
          if (sheetName === SHEET_GESTAO) carregarHistoricoGestao();
          else if (sheetName === SHEET_PROF) carregarHistoricoProfessor();
        } else {
          showAlert('Erro ao excluir: ' + (j && j.message ? j.message : 'Resposta inesperada'));
        }
      } catch(err) {
        console.error('Erro deleteOccurrence:', err); 
        showAlert('Erro ao comunicar com servidor.'); 
      } 
    }

    async function generatePdfFromBackend(occurrenceId) { 
      if (!occurrenceId) { 
        showAlert('ID inválido para geração de PDF.'); 
        return; 
      } 
      
      try {
        const currentSheet = currentUser.role === 'gestao' ? SHEET_GESTAO : SHEET_PROF;

        const resp = await fetch(`${SCRIPT_URL}?endpoint=generate-pdf`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ occurrenceId, sheet: currentSheet })
        }); 
        
        const j = await resp.json(); 
        
        if (j && j.status === 'success' && j.pdfUrl) { 
          window.open(j.pdfUrl, '_blank'); 
        } else { 
          showAlert('Servidor não retornou URL do PDF. Resposta: ' + JSON.stringify(j)); 
        } 
      } catch(err) { 
        console.error('Erro generatePdfFromBackend:', err); 
        showAlert('Erro ao gerar PDF. Verifique se o endpoint generate-pdf existe no Apps Script.'); 
      } 
    }

    function generatePDFLocal() {
      try {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        doc.setFontSize(16);
        doc.text('Registro de Ocorrência', 14, 20);

        const aluno = document.getElementById('aluno_gestao').value || "";
        const turma = document.getElementById('serie_gestao').value || "";
        const prof = document.getElementById('professor_gestao').value || "";
        const desc = document.getElementById('descricao_gestao').value || "";
        let y = 36;

        if (aluno) { doc.text(`Aluno: ${aluno}`, 14, y); y += 8; }
        if (turma) { doc.text(`Turma: ${turma}`, 14, y); y += 8; }
        if (prof) { doc.text(`Professor: ${prof}`, 14, y); y += 8; }

        doc.text('Descrição:', 14, y); y += 8;
        const split = doc.splitTextToSize(desc || 'Sem descrição', 180);
        doc.text(split, 14, y);

        doc.save(`ocorrencia_${Date.now()}.pdf`);
      } catch(err) { 
        console.error('Erro gerar PDF local:', err); 
        showAlert('Erro gerar PDF local.'); 
      }
    }

    // ===== FUNÇÕES AUXILIARES =====
    function showAlert(message) {
      alert(message);
    }

    function showSuccessMessage(elementId) {
      const element = document.getElementById(elementId);
      element.style.display = 'block';
      setTimeout(() => {
        element.style.display = 'none';
      }, 3000);
    }

    function downloadDocument() {
      // Implementar download de templates se necessário
      showAlert('Funcionalidade de download de templates não implementada.');
    }

    function getClassRanges() { 
      return {
        "6° ANO A MANHA": "C3:C46", "6° ANO B MANHA": "H3:H46", "6° ANO C MANHA": "M3:M46", "6° ANO D MANHA": "R3:R46",
        "6° ANO E TARDE": "W3:W46", "6° ANO F TARDE": "AB3:AB46", "7° ANO A TARDE": "AG3:AG46", "7° ANO B TARDE": "AL3:AL46",
        "7° ANO C TARDE": "AQ3:AQ46", "7° ANO D TARDE": "AV3:AV46", "7° ANO E TARDE": "BA3:BA46", "7° ANO F TARDE": "BF3:BF46",
        "8° ANO A TARDE": "BK3:BK46", "8° ANO B TARDE": "BP3:BP46", "8° ANO C TARDE": "BU3:BU46", "8° ANO D TARDE": "BZ3:BZ46",
        "9° ANO A TARDE": "CE3:CE46", "9° ANO B TARDE": "CJ3:CJ46", "9° ANO C TARDE": "CO3:CO46", "9° ANO D TARDE": "CT3:CT46",
        "1ª SERIE A MANHA": "CY3:CY46", "1ª SERIE B MANHA": "DD3:DD46", "1ª SERIE C MANHA": "DI3:DI46", "1ª SERIE D MANHA": "DN3:DN46",
        "1ª SERIE E MANHA": "DS3:DS46", "1ª SERIE F MANHA": "DX3:DX46", "1ª SERIE G TARDE": "EC3:EC46", "1ª SERIE H NOITE": "EH3:EH46",
        "1ª SERIE I NOITE": "EM3:EM46", "2ª SERIE A MANHA": "ER3:ER46", "2ª SERIE B MANHA": "EW3:EW46", "2ª SERIE C MANHA": "FB3:FB46",
        "2ª SERIE D MANHA": "FG3:FG46", "2ª SERIE E MANHA": "FL3:FL46", "2ª SERIE F NOITE": "FQ3:FQ46", "2ª SERIE G NOITE": "FV3:FV46",
        "2ª SERIE H NOITE": "GA3:GA46", "3ª SERIE A MANHA": "GK3:GK46", "3ª SERIE B MANHA": "GP3:GP46", "3ª SERIE C MANHA": "GU3:GU46",
        "3ª SERIE D NOITE": "GZ3:GZ46", "3ª SERIE E NOITE": "HE3:HE46", "3ª SERIE F NOITE": "HJ3:HJ46"
      };
    }

    function getFallbackProfessores() {
      return [
        "ALEX LUTH PEREIRA MARANHAO", "ALEXSANDRA PAULA VARELLA DE SOUZA", "ALISON VASCONCELOS BESERRA", "AMAURI TEODORO DE OLIVEIRA",
        "ANA PAULA DOS SANTOS", "ANDREIA DOS SANTOS FREITAS", "ANDREIA MADUREIRA REIS", "ANTONIO CARLOS DE OLIVEIRA",
        "ANTONIO RAMOS DE ARAUJO", "ANTONIO WILTON WANDERLEY CABRAL", "AUGUSTO LINO PESSOA NETO", "AUREA MARIA DE JESUS MARQUES",
        "CAROLINA PERNOMIAN PARUSSOLOLO", "CASSIA OLIVEIRA ANTONIAZI", "CLAUDINEIA DE AGUIAR LIMA", "DANIEL DE FREITAS ALMEIDA",
        "DANIEL LOPES BARBOSA", "DANIELA FERREIRA LIMA", "DANIELLE LUCIA BATISTA DE ALMEIDA", "EDIANE VIEIRA DA SILVA",
        "EDILEUSA NUNES PEREIRA", "EDUARDO HENRIQUE DA FONSECA", "ELIANE SANTOS SILVA", "ELIAS MONTEIRO DA SILVEIRA",
        "ELISABETE APARECIDA PIRES", "ELZA DE FARIA PEREIRA", "EMERSON GABLER DE ALMEIDA", "EUZELI ARAUJO DE OLIVEIRA",
        "FABIANO AUGUSTO PIEDADE", "FABIO CAMILO", "FERNANDO JOSE DA SILVA FILHO", "FLAVIA CRISTINA APARECIDA BICHLER",
        "FLAVIO CARDOSO FLEURY", "FRANCISCA EDIVANIA DE MORAIS COSTA", "GABRIELA SERIGHELLI DE MELO", "GELSON DE ALMEIDA BATISTA",
        "GENILTON DE OLIVEIRA SILVA", "GIANI CRISTINA DO PRADO", "INGRYD CAROLINA SUGUIMOTO VIEIRA", "IVANILDES DOS SANTOS OSHIKAWA",
        "JANINA DOS PASSOS BRAGA DE ALMEIDA", "JOSE APARECIDO DA SILVA", "JUAREZ GOMES DE MAGALHAES FILHO", "JUREMA SOLEDADE FURINI SANTOS",
        "KATIUSCIA ALVES BOMFIM", "LUANA CAROLINE ALVES LIMA", "LUANA DE FREITAS SILVA", "LUCIANA NOVAIS CORREIA SANTOS",
        "LUCIANO MOREIRA DE AZEVEDO", "MARCIEL DA SILVA", "MARIA HELENA CUNHA MORO", "MARIA QUITÉRIA FERREIRA DOS SANTOS",
        "MARINA DA CONCEICAO FRANCISCO SILVA", "MAURICIO DE BARROS SANTOS", "MICHELE DE PINHO MORAES", "MOISES ANTONIO DE BARROS",
        "PAULA ARMANI VILA", "PAULO ROBERTO DA SILVA ITO", "PEDRO ZANOTTI FILHO", "RAUL PEREIRA VILERA JUNIOR",
        "REGIANE CURTI DE SOUZA OLIVEIRA", "REGINA DA SILVA CASTRO", "RICARDO AMERICO DA SILVA", "ROBERTO SALGADO",
        "RODRIGO VIEIRA", "ROSANGELA CAFASSO MOREIRA", "ROSIMERY DE SOUZA PESSOA", "ROSMARA DA SILVA CARDOSO",
        "SANDRA CRISTINA MACEDO MORAES", "SELMA GOMES DA SILVA", "SERGIO AGRIPINO VILLA NOVA", "SOLANGE ALMEIDA DA SILVA",
        "SUZINEIDE SILVA DE FREITAS", "THIAGO FABIANO BRITO", "TITTO AUGUSTO NASCIMENTO SILVA", "VANDERSON HYPPOLITO",
        "VANESSA IVETE GOMES DOS SANTOS", "VANIA PENHA DE BARROS", "VIVIANE LEAL CAMERA DE MORAES", "WILSON RODRIGUES MOTA"
      ];
    }
  </script>
</body>
</html>
